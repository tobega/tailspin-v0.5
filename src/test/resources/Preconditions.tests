---Failing precondition throws PreconditionFailed
foo templates
requires <|=3>
1 !
end foo

2 -> foo !
=*PreconditionFailed
---Passing precondition works
foo templates
requires <|=3>
1 !
end foo

3 -> foo !
=1
---Failing precondition depends on outer scope value
foo templates
  max is $;
  bar templates
  requires <|..$max>
    1 !
  end bar
  7 -> bar !
end foo

6 -> foo !
=*PreconditionFailed
---Passing precondition depends on outer scope value
foo templates
  max is $;
  bar templates
  requires <|..$max>
    1 !
  end bar
  7 -> bar !
end foo

8 -> foo !
=1
---Failing precondition on inline templates
2 -> templates
       requires <|=3>
       1 !
     end !
=*PreconditionFailed
